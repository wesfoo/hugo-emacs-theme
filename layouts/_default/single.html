{{ define "main" }}
{{- /* Single Article Page - Full-screen content buffer */ -}}

{{- /* Article Content Buffer (active by default) */ -}}
<section class="buffer buffer-content active" 
         id="buffer-content" 
         role="region" 
         aria-label="Article content"
         tabindex="0">
  <div class="buffer-body" id="content-body">
    <article class="post-content" id="article-content">
      <div class="post-header">
        <h1 class="post-title">{{ .Title }}</h1>
        <div class="post-meta">
          {{- if .Date -}}
          <span class="post-date">{{ .Date.Format "2006-01-02" }}</span>
          {{- end -}}
          <span class="post-reading-time">{{ .ReadingTime }} min read ({{ .WordCount }} words)</span>
          {{- with .Params.tags }}
          <div class="post-tags">
            {{- range . }}
            <a href="{{ (urlize (printf "tags/%s/" .)) | absLangURL }}" class="post-tag">{{ . }}</a>
            {{- end }}
          </div>
          {{- end }}
        </div>
      </div>
      
      {{- /* Table of Contents */ -}}
      {{- if (.Params.Toc | default .Site.Params.Toc) }}
      <div class="table-of-contents">
        <h2>{{ (.Params.TocTitle | default .Site.Params.TocTitle) | default "Table of Contents" }}</h2>
        {{ .TableOfContents }}
      </div>
      {{- end }}
      
      <div class="post-body">
        {{ .Content }}
      </div>
      
      {{- /* Post navigation */ -}}
      <nav class="post-navigation" style="margin-top: 3em; padding-top: 1em; border-top: 1px solid var(--border-dim);">
        <div style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 1em;">
          {{- with .PrevInSection }}
          <a href="{{ .RelPermalink }}" style="color: var(--link);">
            &larr; {{ .Title | truncate 40 }}
          </a>
          {{- end }}
          <span style="flex: 1;"></span>
          {{- with .NextInSection }}
          <a href="{{ .RelPermalink }}" style="color: var(--link);">
            {{ .Title | truncate 40 }} &rarr;
          </a>
          {{- end }}
        </div>
      </nav>
    </article>
  </div>
  
  {{ partial "modeline.html" (dict 
    "buffer" (printf "%s.org" .File.BaseFileName)
    "mode" "Org"
    "readonly" true
    "keyhint" "<kbd>q</kbd> back to posts"
  ) }}
</section>
{{ end }}
